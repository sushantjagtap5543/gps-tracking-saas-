const Redis = require('ioredis');
const redis = new Redis(process.env.REDIS_URL);

async function processQueue() {
  while (true) {
    const commandStr = await redis.rpop('command_queue');
    if (commandStr) {
      const { logId, deviceId, actualCommand } = JSON.parse(commandStr);
      // Send to device (from tcp sessions)
      // Wait for ACK
    }
    await new Promise(resolve => setTimeout(resolve, 1000));
  }
}

processQueue();
